# Assignment 2: Changes & Justifications

This document details the key changes made during the implementation of Assignment 2 compared to the original plan in `week-long-project.md`. The primary change was moving from a manual deployment process to a fully automated, robust management script.

### Summary of Key Changes

| Feature                      | Original Plan                                      | Actual Implementation (`assignment2.sh`)                                                                                                                                                            | Justification & Error Avoided                                                                                                                                                                                                                                                           |
| ---------------------------- | -------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Deployment Strategy**      | Manual, one-by-one commands for each service.      | A single, automated, and idempotent script (`assignment2.sh`) that manages the entire application lifecycle (`start`, `stop`, `restart`, `status`, `clean`).                               | **Error Avoided:** The manual approach was highly prone to user error, race conditions (starting services in the wrong order), and configuration drift. The script ensures a reliable, repeatable, and consistent deployment every time.                                                              |
| **Dependency Management**    | Ignored (assumed all tools were pre-installed).    | **Automated Prerequisite Installation**. The script checks for and installs system packages (`nginx`, `redis`, `postgresql`) and creates a dedicated Python virtual environment (`networking_venv`) for `pip` packages. | **Error Avoided:** This prevents script failures due to missing dependencies (e.g., `nginx: command not found` or `ModuleNotFoundError: No module named 'flask'`). It makes the project self-contained and portable to new systems.                                                                      |
| **Service Startup & Reliability** | Simple background processes (`&`) with no error checking. | **Robust, dependency-aware startup logic**. The script includes `wait_for_redis()` and `wait_for_db()` functions, and redirects all service output to log files (`/tmp/*.log`). | **Error Avoided:** The original plan would cause services to crash if they started before their database or cache was ready (a classic race condition). The waiting logic ensures services only start once their dependencies are available, making the system dramatically more stable. |
| **PostgreSQL Setup**         | Vague and incomplete ("this is complex").          | **Fully automated setup**. The script automatically configures PostgreSQL to listen on the correct interface, updates the authentication rules (`pg_hba.conf`), and creates the `orders` database if it doesn't exist. | **Error Avoided:** A manual PostgreSQL setup is complex and error-prone. The script avoids `connection refused` errors by correctly configuring the database to accept connections from the service namespaces, a critical step missing from the original plan.                                   |
| **Lifecycle Management**     | No commands to stop, restart, or check status.     | Clear `start`, `stop`, `restart`, `status`, and `clean` commands.                                                                                                                                 | **Justification:** This provides full operational control over the application stack. Without a `stop` or `clean` command, the only way to stop the services would be to manually find and kill each process (`pkill`), which is inefficient and unreliable.                                     |

