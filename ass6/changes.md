# Assignment 6: Changes & Justifications

This document details the key changes made during the implementation of Assignment 6. This final assignment evolved the project to a true multi-host cluster using Docker Swarm, and the implementation reflects a split between a simplified development workflow and a more robust production-style workflow.

### Summary of Key Changes

The most significant change was **abandoning the manual VXLAN overlay plan** in favor of Docker Swarm's native, more powerful orchestration capabilities. Within the Swarm implementation, two distinct approaches emerged.

| Feature                 | Original Plan                                                                | Definitive "Production" Implementation (`host-a/b` scripts + `docker-compose.yml`)                                                                                                    | Justification & Error Avoided                                                                                                                                                                                                                                                                                       |
| ----------------------- | ---------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Multi-Host Networking** | Proposed a manual VXLAN tunnel to connect two hosts' Docker bridges.         | Used Docker Swarm's native **`overlay` network driver**. The `docker-compose.yml` defines four separate overlay networks that Docker automatically manages across all nodes in the cluster. | **Error Avoided:** A manual VXLAN setup is extremely complex and fragile. It's prone to misconfiguration of IPs, firewall rules, and kernel modules. Docker's overlay networking abstracts all this away, providing a simple, declarative, and reliable way to achieve multi-host communication. |
| **High Availability & Scalability** | Not explicitly addressed in the original plan's Compose file.      | **Service replicas** are explicitly defined in the `docker-compose.yml` (`replicas: 3` for product-service, etc.). Swarm automatically distributes these replicas across the manager and worker nodes. | **Justification:** This is the primary reason to use an orchestrator. It moves the application from a single point of failure (one host) to a resilient cluster. If a worker node fails, Swarm can reschedule its containers on a healthy node, ensuring the service stays available. This cannot be achieved with manual scripts or single-host Docker Compose. |
| **Deployment Model**    | Ambiguous; implied a local build and deploy workflow.                        | The definitive workflow uses **pre-built images from a container registry** (e.g., `junioroyewunmi/api-gateway:1.0`). The build process is separate from deployment.             | **Justification:** This reflects a real-world CI/CD practice. Deploying from a versioned, immutable image in a registry ensures that the exact same tested artifact is used everywhere, eliminating inconsistencies that can arise from building locally on different machines.                                 |
| **Cluster Setup**       | Vague instructions to `docker swarm init`.                                   | Two dedicated, user-friendly scripts (`host-a-manager.sh` and `host-b-worker.sh`) guide the user through creating the cluster, including permission checks and interactive prompts.     | **Error Avoided:** The scripts prevent common but frustrating errors, such as a user without correct Docker group permissions trying to initialize a swarm, or a user not knowing where to find the join token. This makes the complex process of cluster creation much more reliable.           |

### The "Development" Workflow (`manager.sh`)

The `ass6` folder also contains a simplified `manager.sh` script. This was recognized as a separate, introductory workflow rather than the final architecture.

*   **Change:** Instead of using pre-built images and a full stack, this script generates source code, builds images locally, and deploys a smaller, two-service stack.
*   **Justification:** This provides a self-contained way to test basic Swarm concepts (`docker stack deploy`, overlay networking) on a single machine without needing a full multi-node cluster or a Docker Hub account. It serves as an excellent learning tool or a first step, but it was superseded by the more complete "Production" workflow which achieves the true goals of multi-host deployment and high availability.
